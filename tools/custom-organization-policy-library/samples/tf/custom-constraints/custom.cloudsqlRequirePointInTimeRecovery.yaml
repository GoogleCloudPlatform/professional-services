custom.cloudsqlRequirePointInTimeRecovery:
  action_type: DENY
  condition: (resource.databaseVersion.contains("POSTGRES") || resource.databaseVersion.contains("SQLSERVER"))
    && resource.settings.backupConfiguration.pointInTimeRecoveryEnabled == false
  description: Ensure that Cloud SQL instance is configure enable point in time recovery
    in the backup configuration. This setting is possibly for Postgres and SQLServer
    databases.
  display_name: Require Cloud SQL instances to enable point in time recovery
  method_types:
  - CREATE
  - UPDATE
  resource_types:
  - sqladmin.googleapis.com/Instance
