custom.firewallRestrictExplicitAllPortsPolicyRule:
  action_type: DENY
  condition: |-
    resource.rules.exists(rule,
      rule.priority < 2147483644 &&
      rule.direction == 'INGRESS' &&
      rule.match.layer4Configs.exists(l4,
        (l4.ipProtocol == 'tcp' || l4.ipProtocol == 'udp') &&
        has(l4.ports) && l4.ports.exists(port,
          port == '0-65535' || port == '1-65535'
        )
      )
    )
  description: Prevent Firewall Policy rules that explicitly specify all TCP/UDP ports
    using ranges like 0-65535 or 1-65535
  display_name: Restrict Firewall Policy rules with explicit all-ports specifications
  method_types:
  - CREATE
  - UPDATE
  resource_types:
  - compute.googleapis.com/FirewallPolicy
