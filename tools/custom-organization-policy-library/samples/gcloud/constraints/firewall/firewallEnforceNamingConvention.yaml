name: organizations/11111111/customConstraints/custom.firewallEnforceNamingConvention
resource_types:
  - compute.googleapis.com/Firewall
condition: |-
  (
    resource.name.matches("^(allow|deny)-(all|rdp|ssh|tcp|udp|icmp|custom|insecure|open|network|directory|mail|nosql-db|sql-db|mgmt|cache-search-db)[a-z0-9-]*") == false &&
    !resource.name.startsWith("gke-") &&
    !resource.name.startsWith("k8s-") &&
    !resource.name.endsWith("-hc") &&
    !resource.name.startsWith("k8s2-") &&
    !resource.name.startsWith("gkegw1-l7-") &&
    !resource.name.startsWith("gkemcg1-l7-")
  )
action_type: DENY
method_types:
  - CREATE
display_name: Enforce VPC Firewall rule naming convention
description: Prevent the creation of VPC Firewall rule that are not following the naming convention
