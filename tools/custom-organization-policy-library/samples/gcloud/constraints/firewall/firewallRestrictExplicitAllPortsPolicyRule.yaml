name: organizations/11111111/customConstraints/custom.firewallRestrictExplicitAllPortsPolicyRule
resource_types:
- compute.googleapis.com/FirewallPolicy
condition: |-
  resource.rules.exists(rule,
    rule.priority < 2147483644 &&
    rule.direction == 'INGRESS' &&
    rule.match.layer4Configs.exists(l4,
      (l4.ipProtocol == 'tcp' || l4.ipProtocol == 'udp') &&
      has(l4.ports) && l4.ports.exists(port,
        port == '0-65535' || port == '1-65535'
      )
    )
  )
action_type: DENY
method_types:
- CREATE
- UPDATE
display_name: Restrict Firewall Policy rules with explicit all-ports specifications
description: |
  Prevent Firewall Policy rules that explicitly specify all TCP/UDP ports using ranges like 0-65535 or 1-65535
