#!  Copyright 2024 Google LLC
#!
#!  Licensed under the Apache License, Version 2.0 (the "License");
#!  you may not use this file except in compliance with the License.
#!  You may obtain a copy of the License at
#!
#!       http://www.apache.org/licenses/LICENSE-2.0
#!
#!  Unless required by applicable law or agreed to in writing, software
#!  distributed under the License is distributed on an "AS IS" BASIS,
#!  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#!  See the License for the specific language governing permissions and
#!  limitations under the License.

#@ load("@ytt:overlay", "overlay")
#@data/values-schema
---
#@overlay/match missing_ok=True
firewall:
  firewallEnforceNamingConvention:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #@schema/validation min_len=1
      name_regex: ""
  firewallEnforcePolicyRuleLogging:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
  firewallEnforceRuleLogging:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
  firewallRequireDescription:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
  firewallRestrictPublicAccessRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
  firewallRestrictPublicAccessPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
  firewallRestrictRdpRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: true
  firewallRestrictRdpPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: true
  firewallRestrictRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      direction: ""
      source_ranges:
      - ""
      destination_ranges:
      - ""
  firewallRestrictSshRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: true
  firewallRestrictSshPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: true
  firewallRestrictSQLDatabasesRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictSQLDatabasesPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictNoSQLDatabasesRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictNoSQLDatabasesPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictCacheSearchDatabasesRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictCacheSearchDatabasesPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictInsecureProtocolsRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictInsecureProtocolsPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictDirectoryServicesRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictDirectoryServicesPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictNetworkServicesRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictNetworkServicesPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictMailProtocolsRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictMailProtocolsPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictManagementPortsRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictManagementPortsPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
    params:
      #! Optional; when empty, no source ranges are allow‑listed (deny applies to all sources)
      allowed_source_ranges:
      - ""
  firewallRestrictOpenFirewallRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
  firewallRestrictOpenFirewallPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
  firewallRestrictExplicitAllPortsRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
  firewallRestrictExplicitAllPortsPolicyRule:
    #@schema/validation one_of=["default", "skip", "include", "skip-policy"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: false
