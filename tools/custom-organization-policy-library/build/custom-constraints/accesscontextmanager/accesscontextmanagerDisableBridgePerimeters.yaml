#@ load("/constraints.lib.star", "build_constraint")
#@ constraint = build_constraint("accesscontextmanagerDisableBridgePerimeters")

#@ if constraint.to_generate():
name: #@ constraint.constraint_name()
resourceTypes:
- accesscontextmanager.googleapis.com/ServicePerimeter
methodTypes:
- CREATE
- UPDATE
condition: "resource.perimeterType == 'PERIMETER_TYPE_BRIDGE'"
actionType: DENY
displayName: Deny usage of perimeter bridges
description: Ensure no perimeter bridges are used. Instead, use ingress and egress rules.
#@ end