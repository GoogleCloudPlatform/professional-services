displayName: DNS Malformed Queries
documentation:
  content: |-
    Log-based alerting policy in project ${project} detected where DNS queries are malformed or cannot be processed by the DNS server.
    This alert helps monitoring the DNS logs for response code "FORMERR" when malformed DNS queries are sent to the DNS server. ```
      resource.type="dns_query" AND jsonPayload.responseCode="FORMERR"
    ```
  mimeType: text/markdown
conditions:
- displayName: 'Log match condition: dns malformed queries'
  conditionMatchedLog:
    filter: resource.type="dns_query" AND jsonPayload.responseCode="FORMERR"
combiner: OR
notificationChannels:
- projects/dbs-validator-kcc-29ae/notificationChannels/14923856898178156414
alertStrategy:
  notificationRateLimit:
    period: 300s
  autoClose: 604800s
