secretmanagerAllowedTopics:
  description: Detect if unauthorized Pub/Sub topics are used for sending notification events.
  predicate:
    expression: (!resource.topics.all(t,["topic-1", "topic-2"].exists(topic, t.name.endsWith("/topics/" + topic))))
  recommendation: Ensure authorized Pub/Sub topics are used for sending notification events.
  resource_selector:
    resource_types:
      - secretmanager.googleapis.com/Secret
  severity: MEDIUM
