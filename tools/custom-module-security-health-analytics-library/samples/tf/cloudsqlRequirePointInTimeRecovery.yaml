cloudsqlRequirePointInTimeRecovery:
  description: Detect if the CloudSQL instances have point in time recovery disabled
  predicate:
    expression: |-
      (
        !resource.settings.backupConfiguration.binaryLogEnabled &&
        !resource.settings.backupConfiguration.pointInTimeRecoveryEnabled
      )
  recommendation: Ensure the CloudSQL instances have point in time recovery enabled
  resource_selector:
    resource_types:
      - sqladmin.googleapis.com/Instance
  severity: HIGH
